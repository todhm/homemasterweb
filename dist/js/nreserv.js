function InitPage(){openWin("weekendReservModal"),rflag=sessionStorage.getItem("t"),$("html, body").animate({scrollTop:0}),$("#div-title").removeClass(),GetActiveEventsQuery(),kCalendar("r-calendar"),"1"==rflag?($("#div-total-pirce-regular").remove(),$("#div-regular-date").remove(),$("#div-title").addClass("title-once"),$("#div-title p").text("한 번만 서비스 신청하기"),$("#div-date").children("h3").text("클리닝 받고 싶은 날짜를 선택해주세요"),$("#div-calc").children("h3").text("한 번만 클리닝 예상 견적 입니다"),$("#div-total-price-value").children("h2").text("45000원"),$("#div-base-price-value").children("h2").text("45000원"),$("#floating-total-price").text("45000원"),$("#floating-base-price").text("45000원"),rprice=45e3,rtime=3,$("#input-date").val("")):"2"==rflag&&($("#div-total-pirce-once").remove(),$("#div-title").addClass("title-regular"),$("#div-title p").text("정기 클리닝 신청하기"),"매주여러번"==sessionStorage.getItem("per")?($("#div-regular-date").show(),$("input[name=date]").attr("type","checkbox"),$("input:checkbox[name=date]").attr("checked",!1),$("#div-date").children("h3").text("클리닝 받고 싶은 요일,시간을 선택해주세요")):($("#div-regular-date").remove(),$("input[name=date]").attr("type","radio"),$("input:radio[name=date]").attr("checked",!1),$("#div-date").children("h3").text("클리닝 시작 날짜를 선택해주세요")),"2주에한번"==sessionStorage.getItem("per")?($("#div-total-price-value").children("h2").text("42000원"),$("#div-base-price-value").children("h2").text("42000원"),$("#floating-total-price").text("42000원"),$("#floating-base-price").text("42000원")):($("#floating-promotion").show(),$("#div-total-price-promotion").show(),$("#div-calc").children("h3").text("정기 클리닝 예상 견적 입니다"),$("#div-total-price-value").children("h2").text("0원"),$("#div-afterpromotion-price-value").children("h2").text("42000원"),$("#div-base-price-value").children("h2").text("42000원"),$("#floating-total-price").text("0원"),$("#floating-afterpromotion-price").text("42000원"),$("#floating-base-price").text("42000원")),rprice=42e3,rtime=3,$("#input-date").val("")),$("#select-time").each(function(){$(this).find("option:first").attr("selected","true")}),$("input:checkbox[name=addreq]").attr("checked",!1),$("#select-ctype").each(function(){$(this).find("option:first").attr("selected","true")})}function collectData(){var e;if(""==$("#input-date").val())return alert("클리닝 날짜를 선택해 주세요."),$("#input-date").focus(),!1;var t=$("#input-date").val().split(" "),i=t[0].split("년"),a=t[1].split("월"),r=t[2].split("일");if(parseInt(r[0])<10&&parseInt(r[0])>0&&(r[0]="0"+r[0]),t=i[0]+a[0]+r[0],"1"==rflag)e=t;else if("2"==rflag){var d="",n="",o="'"+i[0]+"-"+a[0]+"-"+r[0]+"'",c=parseDate(o);if(console.log("Date Text : "+o),console.log("Parsing Date Text : "+c),period=sessionStorage.getItem("per"),"매주여러번"==period?($("input[name=date]:checked").each(function(e,t){d+=$(t).val(),e!=$("input[name=date]:checked").length-1&&(d+=",")}),n=t+","+d):n=0==c.getDay()?t+",일":1==c.getDay()?t+",월":2==c.getDay()?t+",화":3==c.getDay()?t+",수":4==c.getDay()?t+",목":5==c.getDay()?t+",금":6==c.getDay()?t+",토":t+", "+c.getDay(),""==n)return alert("클리닝 요일를 선택해 주세요."),!1;e=n}if(""==e)return alert("클리닝 날짜를 선택해 주세요."),$("#input-date").val(""),$("#input-date").focus(),!1;console.log(e);var l=$("#select-time").val(),s=$("#select-ctype").val(),u=0,p="";$("input[name=addreq]:checked").each(function(e,t){p+=$(t).val(),e!=$("input[name=addreq]:checked").length-1&&(p+=",")}),"1"==rflag&&(period="1회");var m=60*(rtime+atime+adjustedTime),h=60*(rtime+adjustedTime),f=$("#bdroom-control").find(".countnum").text(),v=$("#baroom-control").find(".countnum").text(),g=rprice+aprice,x={dates:e,time:l,size:s,dirty:u,period:period,total_duration:m,basic_duration:h,tasks:p,rooms:f,baths:v,total_price:g,basic_price:rprice,additional_price:aprice,adjusted_price:adjustedPrice};return console.log(x),$("#value-agree").hasClass("checked")?(sessionStorage.setItem("sd",JSON.stringify(x)),void(location.href="./reserv_info.html")):(alert("주의사항에 동의해 주세요."),$("#value-agree").focus(),window.scrollTo(0,document.body.scrollHeight),!1)}function CalcTimePrice(){var e=$("#select-ctype").val(),t=$("#bdroom-control").find(".countnum").text(),i=$("#baroom-control").find(".countnum").text(),a=0,r=0;if(e<20){rtime=3;var d=parseInt(t)-2,n=parseInt(i)-1;d>0&&(r+=.5*d,rtime+=.5*d),n>0&&(r+=.5*n,rtime+=.5*n)}else if(e>=20&&e<40){rtime=4;var d=parseInt(t)-3,n=parseInt(i)-2;d>0&&(r+=.5*d,rtime+=.5*d),n>0&&(r+=.5*d,rtime+=.5*n)}else if(e>40){rtime=5;var d=parseInt(t)-4,n=parseInt(i)-2;d>0&&(r+=.5*d,rtime+=.5*d),n>0&&(r+=.5*d,rtime+=.5*n)}console.log(r),"1"==rflag?(adjustedPrice=15e3*adjustedTime,rprice=15e3*rtime+adjustedPrice):"2"==rflag&&(d<=0&&n<=0&&e>=20&&e<40&&"0"==a&&adjustedTime<.1?rprice=55e3:(adjustedPrice=14e3*adjustedTime,rprice=14e3*rtime+adjustedPrice));var o=rprice+aprice,c=rtime+atime+adjustedTime;if($("#div-recommended-time").find(".countnum").text(c),$("#floating-ttime-control").find(".countnum").text(c),adjustedTime<.1?($("#div-recommended-time").find(".left").addClass("disabled"),$("#floating-ttime-control").find(".left").addClass("disabled")):($("#div-recommended-time").find(".left").removeClass("disabled"),$("#floating-ttime-control").find(".left").removeClass("disabled")),"1"==rflag)adjustedPrice+=15e3*r,$("#div-total-price-value").children("h2").text(o+"원"),$("#div-base-price-value").children("h2").text(rprice+"원"),$("#div-add-price-value").children("h2").text(aprice+"원"),$("#floating-total-price").text(o+"원"),$("#floating-base-price").text(rprice+"원"),$("#floating-add-price").text(aprice+"원");else if("2"==rflag)if("2주에한번"==sessionStorage.getItem("per"))adjustedPrice+=14e3*r,$("#div-total-price-value").children("h2").text(o+"원"),$("#div-base-price-value").children("h2").text(rprice+"원"),$("#div-add-price-value").children("h2").text(aprice+"원"),$("#floating-total-price").text(o+"원"),$("#floating-base-price").text(rprice+"원"),$("#floating-add-price").text(aprice+"원");else{adjustedPrice+=14e3*r;var l=adjustedPrice+aprice,s=o;$("#div-afterpromotion-price-value").children("h2").text(s+"원"),$("#div-total-price-value").children("h2").text(l+"원"),$("#div-base-price-value").children("h2").text(rprice+"원"),$("#div-add-price-value").children("h2").text(aprice+"원"),$("#floating-afterpromotion-price").text(s+"원"),$("#floating-total-price").text(l+"원"),$("#floating-base-price").text(rprice+"원"),$("#floating-add-price").text(aprice+"원")}0==adjustedTime?($("#div-recommended-time").find(".recom-text").show(),$("#floating-time").find(".recom-text").show()):($("#div-recommended-time").find(".recom-text").hide(),$("#floating-time").find(".recom-text").hide())}function CalcAddReq(e){if($(e).prop("checked"))if("빨래"==$(e).val())aprice+=0,atime+=0;else if("단문형냉장고"==$(e).val())aprice+=3e4,atime+=2;else{if("양문형냉장고"!=$(e).val())return!1;aprice+=45e3,atime+=3}else if("빨래"==$(e).val())aprice-=0,atime-=0;else if("단문형냉장고"==$(e).val())aprice-=3e4,atime-=2;else{if("양문형냉장고"!=$(e).val())return!1;aprice-=45e3,atime-=3}CalcTimePrice()}function parseDate(e){var t=e,i=new Date(t);if("Invalid Date"==i.toString()&&(t=t.split(".").join("-"),i=new Date(t)),"Invalid Date"==i.toString()){var a=t.split(" "),r=a[0];if(i=new Date(r),a.length>1){var d=a[1].split(":");i.setHours(d[0]),i.setMinutes(d[1]),d.length>2&&i.setSeconds(d[2])}}return i}function openWin(e){var t=getCookie(e),i=document.getElementById(e);t||$(i).modal("show")}function closeWin(e,t){setCookie(e,"done",t);var i=document.getElementById(e);$(i).modal("hide")}function getCookie(e){for(var t=e+"=",i=0;i<=document.cookie.length;){var a=i+t.length;if(document.cookie.substring(i,a)==t)return(endOfCookie=document.cookie.indexOf(";",a))==-1&&(endOfCookie=document.cookie.length),unescape(document.cookie.substring(a,endOfCookie));if(i=document.cookie.indexOf(" ",i)+1,0==i)break}return""}function setCookie(e,t,i){var a=new Date;a.setDate(a.getDate()+i),document.cookie=e+"="+escape(t)+"; path=/; expires="+a.toGMTString()+";"}var rflag,rtime=3,atime=0,adjustedTime=0,rprice=0,adjustedPrice=0,aprice=0,period="";window.onpageshow=function(e){e.persisted,InitPage()},$(document).ready(function(){$.fn.preload=function(){this.each(function(){$("<img/>")[0].src=this})};var e=Array("./img/reserv/unchecked.png","./img/reserv/checked.png");$([e[0],e[1]]).preload(),$("#r-calendar").hide(),$("#input-date").click(function(){$("#r-calendar").show()}),$("#input-date-addon").click(function(){$("#r-calendar").show()}),$(".counter-button").click(function(){if($(this).hasClass("disabled"));else{var e=$(this).parent(),t=$(e).children(".counter-label").children(".countnum"),i=parseFloat($(t).text());$(this).hasClass("left")&&!$(this).hasClass("disabled")?($(this).hasClass("counter-button-time")?adjustedTime-=.5:i-=1,i<1.1&&!$(this).hasClass("counter-button-time")?$(e).children(".left").addClass("disabled"):adjustedTime<.5&&$(this).hasClass("counter-button-time")&&$(e).children(".left").addClass("disabled"),$(this).hasClass("counter-button-time")||(i<6&&"bdroom-control"==e.attr("id")?$(e).children(".right").removeClass("disabled"):i<3&&"baroom-control"==e.attr("id")&&$(e).children(".right").removeClass("disabled")),$(t).text(i),CalcTimePrice()):$(this).hasClass("right")&&($(this).hasClass("counter-button-time")?adjustedTime+=.5:i+=1,i>1&&!$(this).hasClass("counter-button-time")?$(e).children(".left").removeClass("disabled"):adjustedTime>0&&$(this).hasClass("counter-button-time")&&$(e).children(".left").removeClass("disabled"),$(this).hasClass("counter-button-time")||(i>5.9&&"bdroom-control"==e.attr("id")?$(e).children(".right").addClass("disabled"):i>2.9&&"baroom-control"==e.attr("id")&&$(e).children(".right").addClass("disabled")),$(t).text(i),CalcTimePrice())}}),$("#select-ctype").change(function(){adjustedTime=0,CalcTimePrice()}),$("input[name=addreq]").change(function(){adjustedTime=0,CalcAddReq($(this))}),$("#value-agree").click(function(){$(this).hasClass("checked")?$(this).removeClass("checked"):$(this).addClass("checked")}),$("#btn-floating").click(function(){collectData()}),$("#btn_ok").click(function(){$("#weekendReservModal").modal("hide")}),$(window).scroll(function(){var e=$(window).scrollTop()+$(window).height()-300,t=$("#div-reception").position().top;$(window).width()>768&&(e>t?$("#floating-info").slideUp("slow"):$("#floating-info").slideDown("slow"))})});