function InitPage(){openWin("weekendReservModal"),rflag=sessionStorage.getItem("t"),$("html, body").animate({scrollTop:0}),$("#div-title").removeClass(),kCalendar("r-calendar"),"1"==rflag?($("#div-regular-date").remove(),$("#div-title").addClass("title-once"),$("#div-title p").text("한 번만 서비스 신청하기"),$("#div-date").children("h3").text("클리닝 받고 싶은 날짜를 선택해주세요"),$("#div-calc").children("h3").text("한 번만 클리닝 예상 견적 입니다"),$("#div-total-price-value").children("h2").text("45000원"),$("#div-base-price-value").children("h2").text("45000원"),rprice=45e3,rtime=3,$("#input-date").val("")):"2"==rflag&&($("#div-title").addClass("title-regular"),$("#div-title p").text("정기 클리닝 신청하기"),"매주여러번"==sessionStorage.getItem("per")?($("#div-regular-date").show(),$("input[name=date]").attr("type","checkbox"),$("input:checkbox[name=date]").attr("checked",!1),$("#div-date").children("h3").text("클리닝 받고 싶은 요일,시간을 선택해주세요")):($("#div-regular-date").remove(),$("input[name=date]").attr("type","radio"),$("input:radio[name=date]").attr("checked",!1),$("#div-date").children("h3").text("클리닝 시작 날짜를 선택해주세요")),$("#div-calc").children("h3").text("정기 클리닝 예상 견적 입니다"),$("#div-total-price-value").children("h2").text("42000원"),$("#div-base-price-value").children("h2").text("42000원"),$("#floating-total-price").text("42000원"),$("#floating-base-price").text("42000원"),rprice=42e3,rtime=3,$("#input-date").val("")),$("#select-time").each(function(){$(this).find("option:first").attr("selected","true")}),$("input:checkbox[name=addreq]").attr("checked",!1),$("#select-ctype").each(function(){$(this).find("option:first").attr("selected","true")})}function collectData(){var a;if(""==$("#input-date").val())return alert("클리닝 날짜를 선택해 주세요."),$("#input-date").focus(),!1;var b=$("#input-date").val().split(" "),c=b[0].split("년"),d=b[1].split("월"),e=b[2].split("일");if(parseInt(e[0])<10&&parseInt(e[0])>0&&(e[0]="0"+e[0]),b=c[0]+d[0]+e[0],"1"==rflag)a=b;else if("2"==rflag){var f="",g="",h="'"+c[0]+"-"+d[0]+"-"+e[0]+"'",i=parseDate(h);period=sessionStorage.getItem("per"),"매주여러번"==period?($("input[name=date]:checked").each(function(a,b){f+=$(b).val(),a!=$("input[name=date]:checked").length-1&&(f+=",")}),g=b+","+f):g=0==i.getDay()?b+",일":1==i.getDay()?b+",월":2==i.getDay()?b+",화":3==i.getDay()?b+",수":4==i.getDay()?b+",목":5==i.getDay()?b+",금":6==i.getDay()?b+",토":b+", "+i.getDay(),a=g}if(""==a)return alert("클리닝 날짜를 선택해 주세요."),$("#input-date").val(""),$("#input-date").focus(),!1;console.log(a);var j=$("#select-time").val(),k=$("#select-ctype").val(),l=0,m="";$("input[name=addreq]:checked").each(function(a,b){m+=$(b).val(),a!=$("input[name=addreq]:checked").length-1&&(m+=",")}),"1"==rflag&&(period="1회");var n=60*(rtime+atime+adjustedTime),o=60*(rtime+adjustedTime),p=$("#bdroom-control").find(".countnum").text(),q=$("#baroom-control").find(".countnum").text(),r=rprice+aprice,s={dates:a,time:j,size:k,dirty:l,period:period,total_duration:n,basic_duration:o,tasks:m,rooms:p,baths:q,total_price:r,basic_price:rprice};return $("#value-agree").hasClass("checked")?(sessionStorage.setItem("sd",JSON.stringify(s)),void(location.href="./reserv_info.html")):(alert("주의사항에 동의해 주세요."),$("#value-agree").focus(),window.scrollTo(0,document.body.scrollHeight),!1)}function CalcTimePrice(){var a=$("#select-ctype").val(),b=$("#bdroom-control").find(".countnum").text(),c=$("#baroom-control").find(".countnum").text(),d=0;if(a<20){if("0"==d){rtime=3;var e=parseInt(b)-2,f=parseInt(c)-1;e>0&&(rtime+=.5*e),f>0&&(rtime+=.5*f)}else if("1"==d){rtime=5;var e=parseInt(b)-2,f=parseInt(c)-1;e>0&&(rtime+=.5*e),f>0&&(rtime+=1*f)}}else if(a>=20&&a<40){if("0"==d){rtime=4;var e=parseInt(b)-3,f=parseInt(c)-2;e>0&&(rtime+=.5*e),f>0&&(rtime+=.5*f)}else if("1"==d){rtime=6;var e=parseInt(b)-3,f=parseInt(c)-2;e>0&&(rtime+=.5*e),f>0&&(rtime+=1*f)}}else if(a>40)if("0"==d){rtime=5;var e=parseInt(b)-4,f=parseInt(c)-2;e>0&&(rtime+=.5*e),f>0&&(rtime+=.5*f)}else if("1"==d){rtime=7;var e=parseInt(b)-4,f=parseInt(c)-2;e>0&&(rtime+=.5*e),f>0&&(rtime+=1*f)}"1"==rflag?rprice=15e3*(rtime+adjustedTime):"2"==rflag&&(rprice=e<=0&&f<=0&&a>=20&&a<40&&"0"==d&&adjustedTime<.1?55e3:14e3*(rtime+adjustedTime));var g=rprice+aprice,h=rtime+atime+adjustedTime;$("#div-recommended-time").find(".countnum").text(h),$("#floating-ttime-control").find(".countnum").text(h),adjustedTime<.1?($("#div-recommended-time").find(".left").addClass("disabled"),$("#floating-ttime-control").find(".left").addClass("disabled")):($("#div-recommended-time").find(".left").removeClass("disabled"),$("#floating-ttime-control").find(".left").removeClass("disabled")),$("#div-total-price-value").children("h2").text(g+"원"),$("#div-base-price-value").children("h2").text(rprice+"원"),$("#div-add-price-value").children("h2").text(aprice+"원"),$("#floating-total-price").text(g+"원"),$("#floating-base-price").text(rprice+"원"),$("#floating-add-price").text(aprice+"원"),0==adjustedTime?($("#div-recommended-time").find(".recom-text").show(),$("#floating-time").find(".recom-text").show()):($("#div-recommended-time").find(".recom-text").hide(),$("#floating-time").find(".recom-text").hide())}function CalcAddReq(a){if($(a).prop("checked"))if("빨래"==$(a).val())aprice+=0,atime+=0;else if("단문형냉장고"==$(a).val())aprice+=3e4,atime+=2;else{if("양문형냉장고"!=$(a).val())return!1;aprice+=45e3,atime+=3}else if("빨래"==$(a).val())aprice-=0,atime-=0;else if("단문형냉장고"==$(a).val())aprice-=3e4,atime-=2;else{if("양문형냉장고"!=$(a).val())return!1;aprice-=45e3,atime-=3}CalcTimePrice()}function parseDate(a){var b=a,c=new Date(b);if("Invalid Date"==c.toString()&&(b=b.split(".").join("-"),c=new Date(b)),"Invalid Date"==c.toString()){var d=b.split(" "),e=d[0];if(c=new Date(e),d.length>1){var f=d[1].split(":");c.setHours(f[0]),c.setMinutes(f[1]),f.length>2&&c.setSeconds(f[2])}}return c}function openWin(a){var b=getCookie(a),c=document.getElementById(a);b||$(c).modal("show")}function closeWin(a,b){setCookie(a,"done",b);var c=document.getElementById(a);$(c).modal("hide")}function getCookie(a){for(var b=a+"=",c=0;c<=document.cookie.length;){var d=c+b.length;if(document.cookie.substring(c,d)==b)return(endOfCookie=document.cookie.indexOf(";",d))==-1&&(endOfCookie=document.cookie.length),unescape(document.cookie.substring(d,endOfCookie));if(c=document.cookie.indexOf(" ",c)+1,0==c)break}return""}function setCookie(a,b,c){var d=new Date;d.setDate(d.getDate()+c),document.cookie=a+"="+escape(b)+"; path=/; expires="+d.toGMTString()+";"}var rflag,rtime=3,atime=0,adjustedTime=0,rprice=0,aprice=0,period="";window.onpageshow=function(a){a.persisted,InitPage()},$(document).ready(function(){$.fn.preload=function(){this.each(function(){$("<img/>")[0].src=this})};var a=Array("./img/reserv/unchecked.png","./img/reserv/checked.png");$([a[0],a[1]]).preload(),$("#r-calendar").hide(),$("#input-date").click(function(){$("#r-calendar").show()}),$("#input-date-addon").click(function(){$("#r-calendar").show()}),$(".counter-button").click(function(){if($(this).hasClass("disabled"));else{var a=$(this).parent(),b=$(a).children(".counter-label").children(".countnum"),c=parseFloat($(b).text());$(this).hasClass("left")&&!$(this).hasClass("disabled")?($(this).hasClass("counter-button-time")?adjustedTime-=.5:c-=1,c<1.1&&!$(this).hasClass("counter-button-time")?$(a).children(".left").addClass("disabled"):adjustedTime<.5&&$(this).hasClass("counter-button-time")&&$(a).children(".left").addClass("disabled"),$(this).hasClass("counter-button-time")||(c<6&&"bdroom-control"==a.attr("id")?$(a).children(".right").removeClass("disabled"):c<3&&"baroom-control"==a.attr("id")&&$(a).children(".right").removeClass("disabled")),$(b).text(c),CalcTimePrice()):$(this).hasClass("right")&&($(this).hasClass("counter-button-time")?adjustedTime+=.5:c+=1,c>1&&!$(this).hasClass("counter-button-time")?$(a).children(".left").removeClass("disabled"):adjustedTime>0&&$(this).hasClass("counter-button-time")&&$(a).children(".left").removeClass("disabled"),$(this).hasClass("counter-button-time")||(c>5.9&&"bdroom-control"==a.attr("id")?$(a).children(".right").addClass("disabled"):c>2.9&&"baroom-control"==a.attr("id")&&$(a).children(".right").addClass("disabled")),$(b).text(c),CalcTimePrice())}}),$("#select-ctype").change(function(){adjustedTime=0,CalcTimePrice()}),$("input[name=addreq]").change(function(){adjustedTime=0,CalcAddReq($(this))}),$("#value-agree").click(function(){$(this).hasClass("checked")?$(this).removeClass("checked"):$(this).addClass("checked")}),$("#btn-floating").click(function(){collectData()}),$("#btn_ok").click(function(){$("#weekendReservModal").modal("hide")}),$(window).scroll(function(){var a=$(window).scrollTop()+$(window).height()-300,b=$("#div-reception").position().top;$(window).width()>768&&(a>b?$("#floating-info").slideUp("slow"):$("#floating-info").slideDown("slow"))})});